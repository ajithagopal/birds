var videoDimention={width:"",height:""};window.birds=[],window.isBirdsNavigation_inProgress=!1;var birdAudio,audioBirds=[];const getData=function(t,e){var i=new XMLHttpRequest;i.onreadystatechange=function(){4!=this.readyState||200!=this.status&&304!=this.status&&206!=this.status||e(this.response),404!=this.status&&500!=this.status||e({status:"failed"})},i.open(t.method,t.url),i.responseType=t.type,i.send()};function thPagination(t,e,i,s=0){this.totalItems=e,this.noOfIemsPerSet=i,this.currentItem=s,this.targetElement=document.getElementById(t),this.prevBtn=document.createElement("button"),this.nxtBtn=document.createElement("button"),this.ul=document.createElement("ul"),this.li=[],this.case="go-next",this.createPrevButton=()=>{this.prevBtn.classList.add("btn","nav-btn","previous","disabled"),this.prevBtn.innerText="previous",this.targetElement.appendChild(this.prevBtn),this.prevBtn.addEventListener("click",this.previous)},this.createNext=()=>{this.nxtBtn.classList.add("btn","nav-btn","next"),this.nxtBtn.innerText="next",this.targetElement.appendChild(this.nxtBtn),this.nxtBtn.addEventListener("click",this.next)},this.createItemNumber=()=>{if(this.ul.classList.add("slide-numbers"),this.li=[],this.ul.innerHTML="","go-next"===this.case)for(var t=this.currentItem;t<this.currentItem+this.noOfIemsPerSet;t++){if(t>=this.totalItems)return;this.li[t]=document.createElement("li"),t==this.currentItem&&this.li[t].classList.add("active"),this.li[t].innerText=t+1;var e=this;this.li[t].addEventListener("click",(function(){e.goTo(this.innerText)}),!1),this.ul.appendChild(this.li[t])}else if("go-prev"===this.case){let i=this.currentItem-this.noOfIemsPerSet+1;for(t=i;t<i+this.noOfIemsPerSet;t++){this.li[t]=document.createElement("li"),t==this.currentItem&&this.li[t].classList.add("active"),this.li[t].innerText=t+1;e=this;this.li[t].addEventListener("click",(function(){e.goTo(this.innerText)}),!1),this.ul.appendChild(this.li[t])}}},this.init=t=>{this.createPrevButton(),this.createItemNumber(),this.targetElement.appendChild(this.ul),this.createNext(),t.call(this.currentItem)},this.next=()=>(this.currentItem++,this.currentItem%this.noOfIemsPerSet==0&&(this.case="go-next",this.createItemNumber()),document.dispatchEvent(new CustomEvent("thPageNext",{bubbles:!0,detail:{item:this.currentItem}})),this.li[this.currentItem]?.classList.add("active"),this.li[this.currentItem-1]?.classList.remove("active"),this.currentItem>0&&this.prevBtn.classList.remove("disabled"),this.currentItem+1===this.totalItems&&this.nxtBtn.classList.add("disabled"),this.currentItem),this.previous=()=>{let t=this.currentItem>0?this.currentItem--:0;return this.currentItem%this.noOfIemsPerSet==this.noOfIemsPerSet-1&&(this.case="go-prev",this.createItemNumber()),document.dispatchEvent(new CustomEvent("thPagePrevious",{bubbles:!0,detail:{item:this.currentItem}})),this.li[t]?.classList.remove("active"),this.li[t-1]?.classList.add("active"),0===this.currentItem&&this.prevBtn.classList.add("disabled"),this.currentItem<this.totalItems&&this.nxtBtn.classList.remove("disabled"),t},this.goTo=t=>(t=Number(t)-1,document.dispatchEvent(new CustomEvent("thPageGoto",{bubbles:!0,detail:{item:t}})),this.currentItem=t,this.ul.querySelector("li.active")?.classList.remove("active"),this.li[t]?.classList.add("active"),t)}function setUpQuizQuestion(t){var e=audioBirds[t],i=document.getElementById("birdAudio");i.setAttribute("data-src",`assets/audio/${e.audio}`),i.pause(),$("#bird-player").addClass("active"),playBirdAudio("np");var s=[t];!function t(e,i){var a=Math.floor(Math.random()*e.length);return-1!==s.indexOf(a)?t(e,i):(s.push(a),s.length<i?t(e,i):void 0)}(audioBirds,4);var a,n=function(t,e){for(let i=0;i<e;i++)t.unshift(t.pop());return t}(s,(a=100,Math.floor(Math.random()*a)%4)),r=document.getElementById("quiz-cards-container");r.innerHTML="",n.forEach((e=>{let i=document.createElement("li");i.classList.add("quiz-card-item"),e===t&&i.setAttribute("data-isans","y");let s=document.createElement("div");s.classList.add("picture");let a=document.createElement("img");a.setAttribute("src",`assets/images/raw/webp/${audioBirds[e].img1url}`),a.setAttribute("alt",audioBirds[e].bird),s.appendChild(a),i.appendChild(s);let n=document.createElement("div");n.classList.add("bird-detail"),n.innerText=audioBirds[e].bird,i.appendChild(n),i.addEventListener("click",(function(t){this.getAttribute("data-isans")?this.classList.add("correct-ans","correct"):(this.classList.add("wrong"),r.querySelector("li[data-isans='y']").classList.add("correct-ans","correct"))})),r.appendChild(i)}))}function showBirdsByCity(t){if(window.isBirdsNavigation_inProgress)return;window.isBirdsNavigation_inProgress=!0,document.getElementById("nav-tab").classList.add("preventClick");var e=window.birds.filter((e=>-1!==e.city.indexOf(t))),i=e.filter((t=>"Common birds"===t.category)),s=e.filter((t=>"Migrant"===t.category)),a=0,n=0,r=document.getElementById("birdsMigratory"),d=document.getElementById("birdsExisting"),o=document.getElementById("birdsMigratory-Title"),l=document.getElementById("birdsExisting-Title");r.innerHTML="",d.innerHTML="",i.length<=0?l.style.display="none":l.style.display="block",s.length<=0?o.style.display="none":o.style.display="block";const c=t=>{let e=document.createElement("li");e.classList.add("citywise-card-item");let i=document.createElement("div");i.classList.add("picture");let s=document.createElement("img");s.setAttribute("src",`assets/images/raw/webp/${t.img1url?t.img1url:t.img2url}`),s.setAttribute("alt",t.bird),i.appendChild(s),e.appendChild(i);let a=document.createElement("div");a.classList.add("bird-name"),a.innerText=t.bird;let n=document.createElement("a");return n.classList.add("bird-click"),n.setAttribute("data-name",t.bird),e.appendChild(a),e.appendChild(n),n.addEventListener("click",(function(t){let e=t.target.getAttribute("data-name");var i=window.birds.filter((t=>t.bird===e));i.length>0&&($(".popup-box").addClass("show-popup"),$("body").addClass("popup-showing"),$(".popup-box .title").html(i[0]?.bird),$(".popup-box .interesting-fact .interesting-fact-info").html(""),i[0].hasOwnProperty("city")&&$(".popup-box .seen-in span").html(i[0].city.replaceAll(",",", ")),i[0].hasOwnProperty("when")?($(".popup-box .when").show(),$(".popup-box .when span").html(i[0].when)):$(".popup-box .when").hide(),$(".popup-box .interesting-fact .interesting-fact-info").html(i[0]?.fact),i[0]?.thlink&&$(".popup-box .interesting-fact .interesting-fact-info").append(`<a href="${i[0]?.thlink}" target="_blank">Read more</a>`),i[0]?.img1?($(".popup-box img.top-img").attr("src",`assets/images/raw/webp/${i[0]?.img1url}`).attr("alt",i[0]?.bird),$(".popup-box img.top-img").show()):$(".popup-box img.top-img").hide(),i[0]?.img2?($(".popup-box img.interesting-fact-img").attr("src",`assets/images/raw/webp/${i[0]?.img2url}`).attr("alt",i[0]?.bird),$(".popup-box img.interesting-fact-img").show()):$(".popup-box img.interesting-fact-img").hide())})),e},u=()=>{if(i[a]){let t=c(i[a]);d.appendChild(t),a++}if(s[n]){let t=c(s[n]);r.appendChild(t),n++}a<=i.length-1||n<=s.length-1?setTimeout((()=>{u()}),250):(window.isBirdsNavigation_inProgress=!1,document.getElementById("nav-tab").classList.remove("preventClick"))};u()}function playBirdAudio(t){if(birdAudio.pause(),"np"!==t)return $("#bird-player").attr("data-status","np"),void $("#bird-player").removeClass("active");$("#bird-player").attr("data-status","p"),$("#bird-player").addClass("active"),$("#player-content").addClass("show-loading").removeClass("onpause");let e=$("#birdAudio").attr("data-src"),i=document.getElementById("birdAudio").src.replace(/^\s+|\s+$/gm,"");getData({url:e,method:"GET",type:"blob"},(t=>{if(!t.hasOwnProperty("status")){if(birdAudio.src=window.URL.createObjectURL(t),birdAudio.load(),$("#player-content").removeClass("show-loading"),-1==i.indexOf("http"))return $("#bird-player").attr("data-status","np"),$("#bird-player").removeClass("active"),void $("#player-content").addClass("onpause");birdAudio.play();var e=new(window.AudioContext||window.webkitAudioContext),s=e.createMediaElementSource(birdAudio),a=e.createAnalyser();s.connect(a),a.connect(e.destination),a.fftSize=256;var n,r=a.frequencyBinCount,d=new Uint8Array(r),o=window.canvas.width,l=window.canvas.height,c=o/r*2.5,u=0;-1!=i.indexOf("http")&&birdAudio.play(),function t(){requestAnimationFrame(t),u=0,a.getByteFrequencyData(d),window.ctx.fillStyle="#FFFFFF",window.ctx.fillRect(0,0,o,l);for(var e=0;e<r;e++){var i=(n=d[e])+e/r*25,s=e/r*250;window.ctx.fillStyle="rgb("+i+","+s+",50)",window.ctx.fillRect(u,l-n,c,n),u+=c+1}}()}}))}$(document).ready((function(){var t=document.body.clientWidth;t<500?($("#mask circle").attr("r",140),$("#mask #mask-circle-2").attr("cx",220),$("#binoLines image").attr("x","-125").attr("y","-114").attr("width","470").attr("height","293.75")):t<900&&($("#mask circle").attr("r",180),$("#mask #mask-circle-2").attr("cx",300),$("#binoLines image").attr("x","-153").attr("y","-150").attr("width","600").attr("height","375"));var e=window.scrollY;$(this).scroll((function(){if($(this).scrollTop()>100){var t=window.scrollY;e>t?($(".header").addClass("header-move"),$(".header").css("transform","translateY(0px)")):$(".header").css("transform","translateY(-100px)"),e=t}else $(this).scrollTop()<=10&&$(".header").removeClass("header-move");e=window.scrollY})),$(".share-btn").click((function(){var t=$("title").text(),e=window.location.href;navigator.share&&void 0!==t&&void 0!==e&&/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)?navigator.share({title:t,text:t,url:e}):$(this).next(".share-list").toggle()})),$(".birds-list-box .birds-list li").click((function(){$(".popup-box").addClass("show-popup"),$("body").addClass("popup-showing")})),$(".popup .popup-close, .popup-overlay").click((function(){$(".popup-box").removeClass("show-popup"),$("body").removeClass("popup-showing")})),videoDimention.width=$("#birds-intro-video").width(),videoDimention.height=$("#birds-intro-video").height(),$(".birds-hero-dark svg, .birds-hero-dark rect").attr("width",videoDimention.width+"px").attr("height",videoDimention.height+"px"),window.canvas=document.getElementById("birdCanvas"),window.canvas.width=600,window.canvas.height=150,window.ctx=canvas.getContext("2d"),birdAudio=document.getElementById("birdAudio"),$("#bird-player").click((function(){playBirdAudio($(this).attr("data-status"))})),birdAudio.onended=()=>{$("#bird-player").attr("data-status","np"),$("#bird-player").removeClass("active"),$("#player-content").addClass("onpause")},birdAudio.onpause=()=>{$("#bird-player").attr("data-status","np"),$("#bird-player").removeClass("active"),$("#player-content").addClass("onpause")},birdAudio.onplay=()=>{$("#bird-player").attr("data-status","p"),$("#bird-player").addClass("active"),$("#player-content").removeClass("onpause")},getData({url:"assets/js/birds.json",method:"GET",type:"json"},(t=>{window.birds=t;new thPagination("birds-quiz-pagination",(audioBirds=t.filter((t=>t.hasOwnProperty("audio")))).length,5,0).init((()=>{setUpQuizQuestion(0)})),showBirdsByCity("Chennai")})),document.addEventListener("thPageNext",(t=>{setUpQuizQuestion(t.detail.item)})),document.addEventListener("thPagePrevious",(t=>{setUpQuizQuestion(t.detail.item)})),document.addEventListener("thPageGoto",(t=>{setUpQuizQuestion(t.detail.item)})),$("#nav-tab button.nav-link").click((function(){$("#nav-tab button.nav-link").removeClass("active");var t=$(this).text();$(this).addClass("active"),showBirdsByCity(t)}))})),$(document).mouseup((function(t){var e=$(".share-btn");e.is(t.target)||0!==e.has(t.target).length||$(".share-list").slideUp()}));